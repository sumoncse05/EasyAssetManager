@model EasyAssetManagerCore.Models.EntityModel.AccountOpeningReq
@{
    ViewData["Title"] = "Account Authorize Preview";
    Model.cheque_book = Model.cheque_book == "Y" ? "Yes" : "No";
    Model.debit_card = Model.debit_card == "Y" ? "Yes" : "No";
}


<div class="wrapper wrapper-content animated fadeInRight">

    <div class="row">
        <div class="col-lg-12">

            <div class="ibox">
                <div class="ibox-title">
                    <h5>Customer Details </h5>
                </div>
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-lg-12">
                            <form id="agentSetup">
                                <div class="col-lg-12" style="border:solid 1px;">
                                    <div class="form-group row">
                                        <div class="col-xl-12 ibox-heading">
                                            <h4 class="col-form-label">From Agent</h4>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <input type="hidden" id="ac_reg_slno" value="@Model.ac_reg_slno" name="ac_reg_slno"/>
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Account Name:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input type="text" id="ac_name" name="ac_name" class="form-control form-element" value="@Model.ac_name" readonly />
                                        </div>
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Cheque Book:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input type="text" id="cheque_book" name="cheque_book" class="form-control form-element" value="@Model.cheque_book" readonly />
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Debit Card:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input type="text" id="debit_card" name="debit_card" class="form-control form-element" value="@Model.debit_card" readonly />
                                        </div>
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Remarks:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input type="text" id="remarks" name="remarks" class="form-control form-element" value="@Model.remarks" readonly />
                                        </div>
                                    </div>
                                   <hr />

                                    <div class="form-group row">
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Account Opening Ref. No.:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input type="text" id="AcSlNo" name="AcSlNo" class="form-control form-element" />
                                        </div>
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Account No:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input class="form-control form-element" type="text" id="cust_ac_no" name="cust_ac_no" />
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Account Desc UBS:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input class="form-control form-element" type="text" id="acDes" name="acDes"  readonly />
                                        </div>
                                        <div class="col-xl-2">
                                            <label class="col-form-label">Account Open Date:</label>
                                        </div>
                                        <div class="col-xl-3">
                                            <input class="form-control form-element" type="text" id="accOpenDate" name="accOpenDate"  readonly />
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <div class="col-xl-8"></div>
                                        <div class="col-xl-1">
                                            <input type="button" value="Authorize Account" class="btn btn-primary ks-next" id="btnConfirm">
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

@section Scripts {
    <script type="text/javascript">
        var classAuthorizeAccountPreview = function ()
        {
            var init = function ()
            {
                eventInitializer();
            };
            var eventInitializer = function ()
            {
                $('#btnConfirm').click(authorizeAccount);
                $('#cust_ac_no').on('keyup', getAccountInfo);
            };

            var authorizeAccount = function ()
            {
                if ($('#ac_reg_slno').val()) {
                    var formData = new FormData();
                    formData.append("ac_reg_slno", $('#ac_reg_slno').val());
                    formData.append("cust_ac_no", $('#cust_ac_no').val());
                    formData.append("ac_desc", $('#acDes').val());
                    formData.append("accOpenDate", $('#accOpenDate').val());
                    var url = '/AccountOpening/AuthorizeAccount';
                ApplicationCommon.request(url, 'POST', formData, false, true, false, function (res)
                {
                    ApplicationCommon.showNotification(res.messageType, res.messageString);
                    if (res.messageType == 1)
                    {
                        ApplicationCommon.clearFields();
                    }
                });
                } else {
                    ApplicationCommon.showNotification("2", "Account already authorize.");
                }
            };

            var getAccountInfo = function ()
            {
                var cust_ac_no = $('#cust_ac_no').val();
                var url = "/AccountOpening/GetAccountDtlCbs";
                ApplicationCommon.request(url, 'GET', { cust_ac_no: cust_ac_no }, false, true, false, function (res)
                {
                    if (res != null)
                    {
                        $('#acDes').val(res.ac_desc);
                        $('#accOpenDate').val(res.ac_open_date);
                    } else
                    {
                        ApplicationCommon.showNotification("2", "Data not found.");
                    }
                });
            };
            return { init: init };
        }();

        classAuthorizeAccountPreview.init();
    </script>
}

