@model IEnumerable<EasyAssetManagerCore.Models.EntityModel.User>
@{
    Layout = null;
}
@if (Model != null && Model.Any())
{
    <table class="table table-striped table-bordered table-hover dataTables-example table-responsive" id="tb-activeUser" width="100%">
        <thead>
            <tr>
                <th class="collapse">User ID</th>
                <th>User Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Created By</th>
                <th>Created Date</th>
                <th>Updated By</th>
                <th>Updated Date</th>
                <th>Authorized By</th>
                <th>Authorized Date</th>
                <th>User Status</th>
                <th>Edit</th>
                <th>Delete</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var v in Model)
            {
                <tr>
                    <td class="collapse">@v.USER_ID</td>
                    <td>@v.USER_NAME</td>
                    <td>@v.EMAIL </td>
                    <td>@v.PHONE</td>
                    <td>@v.INS_BY</td>
                    <td>@v.INS_DATE</td>
                    <td>@v.UPD_BY</td>
                    <td>@v.UPD_DATE</td>
                    <td>@v.AUTH_BY</td>
                    <td>@v.AUTH_DATE</td>
                    <td>@v.USER_STATUS</td>
                    @if (v.AUTH_DATE == null)
                    {
                        <td>
                            <a href="/AppUserSetup/Index?user_id=@v.USER_ID" class="btn btn-success gridButton" data-id="@v.USER_ID"><i class="fa fa-edit"></i></a>

                        </td>
                        <td>

                            <button type="button" class="btn btn-danger gridButton" onclick="DeleteUser('@v.USER_ID');" data-id="@v.USER_ID">
                                <i class="fa fa-trash"></i>
                            </button>

                        </td>
                        <td></td>
                    }
                    else if (v.ACTIVE == "Y")
                    {
                        <td>

                            <button type="button" class="btn btn-success gridButton" onclick="showUpdatedata('@v.USER_ID','@v.USER_NAME','@v.ACTIVE');" data-id="@v.USER_ID">
                                <i class="fa fa-edit"></i>
                            </button>

                        </td>
                        <td></td>
                        <td>

                            <button type="button" class="btn btn-success gridButton" onclick="emailUserDetail('@v.USER_ID');" data-id="@v.USER_ID">
                                <i class="fa fa-send"></i>
                            </button>

                        </td>
                    }
                    else
                    {
                        <td></td>
                        <td></td>
                        <td></td>
                    }
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>No record found.</p>
}
<div class="modal fade" id="updateData" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel"> Update User</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label class="col-form-label">User ID<span class="required">*</span></label>
                        <input type="text" id="user_id" name="user_id" class="form-control form-element" readonly="readonly" />
                    </div>
                    <div class="form-group">
                        <label class="col-form-label">User Name<span class="required">*</span></label>
                        <input type="text" id="user_name" name="user_name" class="form-control form-element" readonly="readonly" />
                    </div>
                    <div class="form-group">
                        <label class="col-form-label">Status<span class="required">*</span></label>
                        <select class="form-control form-element required" id="user_status" name="user_status" data-validation-error-msg="Select status to continue" data-validation="alphanumeric"></select>
                    </div>
                    <div class="form-group">
                        <label class="col-form-label">Reason<span class="required">*</span></label>
                        <textarea id="inactive_reason" name="inactive_reason" class="form-control form-element required"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <input type="button" value="Update" class="btn btn-primary ks-next" onclick="classUserListSearch.Updatedata()" id="update">
                <input type="button" value="Close" class="btn btn-danger ks-next" data-dismiss="modal" id="btnClose">
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        combo.getUserActiveStatus('user_status', true);
        $("#user_status option[value='Y']").remove();
        ApplicationCommon.makePagination("tb-activeUser");

        var rowCount = $('#tb-activeUser >tbody >tr').length;
        if (rowCount > 0) {
            $("#sidebarCollapse").addClass('fa-chevron-down').removeClass('fa-chevron-up');
            $("#divsidebarCollapse").addClass('border-bottom');
            $('#sidebarContent').css('display', 'none');
        }
    });
    function showUpdatedata(user_id, user_name, active) {
        $('#updateData').modal('show');
        $("#user_id").val(user_id);
        $("#user_name").val(user_name);
    };
    function emailUserDetail(user_id) {
        if (confirm("Do you really want to email the user details again?(Yes/No)")) {
            var formData = new FormData();
            formData.append("user_id", user_id);
            var url = '/AppUserList/EmailUserDetails';
            ApplicationCommon.request(url, 'POST', formData, false, true, false, function (res) {
                ApplicationCommon.showNotification(res.messageType, res.messageString);
            });
        }
    };
    function DeleteUser(user_id) {
        if (confirm("Do you really want to delete this user?(Yes/No)")) {
            var formData = new FormData();
            formData.append("user_id", user_id);
            var url = '/AppUserList/DeleteUser';
            ApplicationCommon.request(url, 'POST', formData, false, true, false, function (res) {
                ApplicationCommon.showNotification(res.messageType, res.messageString);
            });
        }
    };

</script>

